<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sneaklife.pms.dao.system.authority.roleFunction.RoleFunctionMapper">

  <insert id="insertRoleFunction" parameterType="map">

  </insert>
  <update id="updateRoleFunction" parameterType="map">

  </update>
  <delete id="deleteRoleFunction" parameterType="map">

  </delete>

  <select id="getByIsDel" parameterType="int" resultType="com.sneaklife.pms.entity.RoleFunction">
    select * from role_function
    <where>
      is_del = #{isDel}
    </where>
  </select>

  <sql id="getGroupByRoleIdSql">
    ID,CREATE_DATE,IS_DEL,GROUP_CONCAT(menu_id) AS MENU_ID,ROLE_ID,UPDATE_DATE
  </sql>
  <select id="getGroupByRoleId" resultType="com.sneaklife.pms.entity.RoleFunction">
    SELECT <include refid="getGroupByRoleIdSql"/> from role_function
    where role_id = #{roleId} and is_del = 0
  </select>

  <delete id="deleteByRoleId" parameterType="string">
    delete from role_function
    <where>
      1 = 1
      and role_id = #{roleId}
    </where>
  </delete>

  <insert id="insertBatch" parameterType="list">
    insert into role_function
    (
      menu_id,
      role_id,
      is_del,
      create_date,
      update_date
    )
    values
    <foreach collection="list" item="item" index="index" separator=",">
      (#{item.treeViewId},#{roleId},0,NOW(),NOW())
    </foreach>
  </insert>

  <select id="getById" parameterType="string" resultType="com.sneaklife.pms.entity.RoleFunction">
    select * from role_function
    <where>
      is_del = 0
      and role_id = #{roleId}
    </where>
  </select>
</mapper>
